<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>å¸å®‰ Web3 é’±åŒ…ç¬¬25æœŸ IDO ä¸Šçº¿ ($BEE)</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<meta name="color-scheme" content="light dark">
<style>
:root{
  --c-bg:#f9f9f9;       --c-card:#fff;
  --c-text:#222;        --c-sub:#555;
  --c-primary:#0078d4;  --c-primary-dark:#005fa3;
  --c-success:#16a34a;  --c-error:#dc2626;  --c-refund:#0284c7;
}
@media (prefers-color-scheme:dark){
  :root{
    --c-bg:#111827;--c-card:#1f2937;
    --c-text:#f3f4f6;--c-sub:#9ca3af;
  }
}
body{margin:0;padding:0;font-family:-apple-system,Segoe UI,PingFang SC,Helvetica,Arial,sans-serif;background:var(--c-bg);color:var(--c-text)}
.container{max-width:660px;margin:40px auto;background:var(--c-card);padding:34px;border-radius:18px;box-shadow:0 10px 24px rgba(0,0,0,.08)}
h2{color:var(--c-primary);text-align:center;margin-bottom:28px}
label{display:block;margin:18px 0 8px;font-weight:700;color:var(--c-text)}
.note{font-size:13px;color:var(--c-sub);font-weight:400;margin-left:4px}
input,select{width:100%;padding:12px;font-size:15px;border:1px solid #ccc;border-radius:10px;box-sizing:border-box;background:var(--c-card);color:var(--c-text)}
button{width:100%;padding:13px;font-size:16px;background:var(--c-primary);color:#fff;border:none;border-radius:10px;margin-top:24px;cursor:pointer;transition:background-color .2s}
button:hover{background:var(--c-primary-dark)}
.progress-container{margin-top:34px}
.progress-bg{background:#e5e7eb;height:14px;border-radius:10px;overflow:hidden}
.progress-bar{background:var(--c-primary);height:100%;width:0%;transition:width .4s}
.countdown{text-align:right;margin-top:6px;font-size:14px;color:var(--c-sub)}
.result{background:var(--c-bg);margin-top:34px;padding:22px;border-radius:14px;border:1px solid #d1d5db}
.result p{margin:10px 0;font-size:15px;line-height:1.45}
.highlight{font-weight:700}
.success{color:var(--c-success);font-weight:700}
.deduct{color:var(--c-error);font-weight:700}
.refund{color:var(--c-refund);font-weight:700}
.tutorial-link{display:block;text-align:center;margin-top:18px;font-weight:700;text-decoration:none;color:var(--c-primary)}
.tutorial-link:hover{text-decoration:underline}
.updateHint{text-align:right;font-size:13px;color:var(--c-sub);margin-top:10px}
.error-banner{display:none;padding:10px 14px;margin-bottom:18px;background:var(--c-error);color:#fff;border-radius:10px;font-size:14px}
</style>
</head>
<body>
<div class="container">
  <div id="errBanner" class="error-banner"></div>

  <h2>å¸å®‰ Web3 é’±åŒ…ç¬¬25æœŸ IDO ä¸Šçº¿ ($BEE)</h2>

  <label>é€‰æ‹©ä»£å¸</label>
  <select id="tokenSelect"><option value="BEE">BEE</option></select>

  <input id="targetAddress" type="hidden" value="0xbF9ed8b76a1E15cCE336dbD7ddc3D5014fa390Da">

  <label>æŠ•å…¥ BNB</label>
  <input id="userAmount" type="number" step="0.01" value="3" min="0">

  <label>
    ä»£å¸å•ä»· (USD)
    <span class="note">å¯è‡ªå¡«ï¼›é»˜è®¤ 0.075ï¼ˆæŒ‰å¹³å‡æ¯æœŸ IDO ç©ºæŠ•é‡‘é¢ â‰ˆ 150 ä¸‡ USD æ¨ç®—ï¼‰</span>
  </label>
  <!-- æ¢å¤ç¼ºå¤±çš„ tokenPrice è¾“å…¥æ¡† -->
  <input id="tokenPrice" type="number" step="0.00001" value="0.075" min="0">

  <!-- éšè—çš„ BNB ä»·æ ¼è¾“å…¥ -->
  <input id="bnbPrice" type="number" value="650" style="display:none">

  <button id="refreshBtn">ğŸ”„ åˆ·æ–°æ•°æ®</button>
  <div class="updateHint" id="lastUpdateHint">â€”</div>

  <a class="tutorial-link" href="https://x.com/0xXIAOc/status/1935219947300602290" target="_blank">ğŸ“˜ æå‰æˆæƒ BEE æ•™ç¨‹å…¥å£</a>
  <a class="tutorial-link" href="https://x.com/0xXIAOc/status/1929136552757830056" target="_blank">ğŸ’¸ å€Ÿ BNB æ•™ç¨‹å…¥å£</a>
  <a class="tutorial-link" href="https://x.com/0xXIAOc" target="_blank">ğŸ¦ ä½œè€…æ¨ç‰¹ @0xXIAOc</a>

  <div class="progress-container">
    <div class="progress-bg"><div class="progress-bar" id="progressBar"></div></div>
    <div class="countdown" id="countdownText">å€’è®¡æ—¶åŠ è½½ä¸­â€¦</div>
  </div>

  <div class="result" id="resultBox" style="display:none">
    <p>ğŸ“¦ å½“å‰åœ°å€ BNB ä½™é¢ï¼š<span class="highlight" id="bnbBalance">â€”</span></p>
    <p>ğŸ¯ å‹Ÿé›†ç›®æ ‡ï¼š<span id="targetShow">å¾…æ›´æ–°</span></p>
    <p>ğŸ”¥ è¶…å‹Ÿå€æ•°ï¼š<span class="highlight" id="multiplier">â€”</span></p>
    <p>ğŸ’° æ€»é”€å”®é‡ï¼š20 000 000 æš BEE</p><hr>
    <p>ğŸš€ ä½ æŠ•å…¥ <span class="highlight" id="userInput">â€”</span> BNBï¼ˆå æ¯” <span class="highlight" id="percent">â€”</span>%ï¼‰<br>
       å¯è·å¾— <span class="success" id="cudisAmount">â€”</span> æš BEE â‰ˆ <span class="success" id="usdValue">â€”</span></p>
    <p>ğŸ’¸ å®é™…æ‰£æ¬¾ï¼š<span class="deduct" id="principalBNB">â€”</span> BNB â‰ˆ <span class="deduct" id="principalUSD">â€”</span></p>
    <p>ğŸ”„ é€€å› BNBï¼š<span class="refund" id="refundBNB">â€”</span> BNB â‰ˆ <span class="refund" id="refundUSD">â€”</span></p>
  </div>
</div>

<script>
/* â€”â€” é…ç½® â€”â€” */
const CONFIG={
  TOTAL_TARGET_BNB:0,                     // â† å¡«å®é™…ç›®æ ‡
  TOTAL_TOKENS:20_000_000,
  START_TIME:new Date('2025-06-18T16:00:00+08:00'),
  END_TIME:new Date('2025-06-18T18:00:00+08:00'),
  REFRESH_INTERVAL:60_000,
  RPC_NODES:[
    'https://bsc-dataseed.binance.org/',
    'https://bsc-dataseed1.defibit.io/',
    'https://bsc-dataseed1.ninicoin.io/'
  ]
};

/* â€”â€” å…ƒç´  â€”â€” */
const $=id=>document.getElementById(id);
const els=['userAmount','tokenPrice','bnbPrice','bnbBalance','multiplier','userInput','percent',
  'cudisAmount','usdValue','principalBNB','principalUSD','refundBNB','refundUSD','resultBox',
  'countdownText','progressBar','refreshBtn','lastUpdateHint','targetShow','errBanner','targetAddress']
  .reduce((o,i)=>(o[i]=$(i),o),{});

/* â€”â€” å·¥å…· â€”â€” */
const fmt=(n,d=4)=>Number(n).toLocaleString(undefined,{maximumFractionDigits:d});
const fmtUSD=n=>'$'+fmt(n,2);
const fetchJSON=(u,o)=>fetch(u,o).then(r=>r.json());

async function fetchBalance(addr){
  const body=JSON.stringify({jsonrpc:'2.0',method:'eth_getBalance',params:[addr,'latest'],id:1});
  const opts={method:'POST',headers:{'Content-Type':'application/json'},body};
  try{
    const {result}=await Promise.any(CONFIG.RPC_NODES.map(u=>fetchJSON(u,opts)));
    return BigInt(result);
  }catch{throw new Error('æ‰€æœ‰ RPC èŠ‚ç‚¹å‡ä¸å¯ç”¨');}
}

/* è®¡ç®— & æ¸²æŸ“ */
function render(dep){
  const user=+els.userAmount.value||0,
        price=+els.tokenPrice.value||0,
        bnbUSD=+els.bnbPrice.value||0,
        target=CONFIG.TOTAL_TARGET_BNB;
  if(!(user&&price&&bnbUSD&&target&&dep)){els.resultBox.style.display='none';return;}

  const share=user/dep, tokens=share*CONFIG.TOTAL_TOKENS,
        principal=share*target, refund=user-principal, multi=dep/target;

  els.bnbBalance.textContent=fmt(dep);
  els.multiplier.textContent=fmt(multi,2);
  els.targetShow.textContent=fmt(target);
  els.userInput.textContent=fmt(user,2);
  els.percent.textContent=fmt(share*100,4);
  els.cudisAmount.textContent=fmt(tokens,2);
  els.usdValue.textContent=fmtUSD(tokens*price);
  els.principalBNB.textContent=fmt(principal,4);
  els.principalUSD.textContent=fmtUSD(principal*bnbUSD);
  els.refundBNB.textContent=fmt(refund,4);
  els.refundUSD.textContent=fmtUSD(refund*bnbUSD);
  els.resultBox.style.display='block';
}

/* åˆ·æ–° */
let refreshing=false,lastTap=0;
async function refresh(){
  if(Date.now()-lastTap<1500||refreshing)return; lastTap=Date.now(); refreshing=true;
  els.refreshBtn.disabled=true; els.refreshBtn.textContent='â³ åˆ·æ–°ä¸­â€¦'; els.errBanner.style.display='none';
  try{
    const wei=await fetchBalance(els.targetAddress.value);
    render(parseFloat((wei/10n**18n).toString()));
    els.lastUpdateHint.textContent='æœ€åæ›´æ–°æ—¶é—´ï¼š'+new Date().toLocaleTimeString('zh-CN',{hour12:false});
  }catch(e){els.errBanner.textContent=e.message; els.errBanner.style.display='block';}
  finally{els.refreshBtn.disabled=false; els.refreshBtn.textContent='ğŸ”„ åˆ·æ–°æ•°æ®'; refreshing=false;}
}

/* å€’è®¡æ—¶ & è¿›åº¦æ¡ */
function tick(){
  const now=Date.now();
  if(now<CONFIG.START_TIME){
    els.countdownText.textContent='æ´»åŠ¨æœªå¼€å§‹'; els.progressBar.style.width='0%';
  }else if(now>=CONFIG.END_TIME){
    els.countdownText.textContent='å·²ç»“æŸ'; els.progressBar.style.width='100%'; stopPoll();
    els.refreshBtn.disabled=true; els.refreshBtn.textContent='â¹ å·²ç»“æŸ';
  }else{
    const diff=CONFIG.END_TIME-now;
    const txt=diff<60_000?`${Math.floor(diff/1e3)} ç§’`
             :`${Math.floor(diff/3.6e6)} å°æ—¶ ${Math.floor(diff%3.6e6/6e4)} åˆ†`;
    els.countdownText.textContent='å‰©ä½™æ—¶é—´ï¼š'+txt;
    els.progressBar.style.width=((now-CONFIG.START_TIME)/(CONFIG.END_TIME-CONFIG.START_TIME)*100).toFixed(2)+'%';
  }
}

/* è½®è¯¢æ§åˆ¶ */
let poll=null,clock=null;
function startPoll(){ if(!poll) poll=setInterval(refresh,CONFIG.REFRESH_INTERVAL); if(!clock) clock=setInterval(tick,1e3); }
function stopPoll(){ clearInterval(poll); poll=null; clearInterval(clock); clock=null; }

document.addEventListener('visibilitychange',()=>document.hidden?stopPoll():startPoll());

/* äº‹ä»¶ç»‘å®š */
els.refreshBtn.addEventListener('click',refresh);
window.addEventListener('load',()=>{ refresh(); tick(); startPoll(); });
window.addEventListener('beforeunload',stopPoll);
</script>
</body>
</html>
